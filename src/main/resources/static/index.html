<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!DOCTYPE html>
<html>
<head>
	<meta http-equiv="content-type" content="text/html; charset=UTF-8">
	<meta name="Author" content="Gerard Ferrandez at http://www.dhteumeuleu.com/">
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
	<title>Index</title>
	<script src="https://cdn.bootcdn.net/ajax/libs/jquery/3.5.1/jquery.js"></script>
</head>
<body>
<script type="text/javascript">
	window.onload = function() {
		if(!window.localStorage) {
			alert("浏览器支持localstorage");
			return false;
		}else {
			var storage = window.localStorage;
			userName = storage.userName;
			if (userName == null) {
				userName = prompt("请输入用户名","");
				pd = prompt("请输入口令","");
				if (userName == '' || pd == ''){
					alert("请重新输入用户名密码--");
					userName = prompt("请输入用户名","");
				}
				$.ajax({
					type: 'POST',
					url: "/api/albumUser/createAndLogin" ,
					cache:false,
					dataType: "json",
					data: JSON.stringify({userName: userName, password:pd}),
					headers: { "Content-Type": "application/json;charset=utf-8" },
					success: function(data){
						if (data.responseCode == 200) {
							storage["userName"] = userName;
							window.location.href = userName+"/index.html";
						} else {
							alert(data.messageList[0].message);
						}
					}
				})
			} else {
				window.location.href = userName+"/index.html";
			}
		}
	};
</script>
</body>
</html>
